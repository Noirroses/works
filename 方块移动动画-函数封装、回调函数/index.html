<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        div{
            width: 60px;
            height: 60px;
            position: absolute;
            top: 40px;
            left: 20px;
            border-radius: 5px;
            background: red;
        }
    </style>
    <script>
        window.onload = function () {
            var div = document.getElementById('div');
            var btn1 = document.getElementById('btn1');
            var btn2 = document.getElementById('btn2');


            btn1.onclick = function () {

                moveFn(div,'left',12,900);
                /**
                 clearInterval(div.timer);
                 div.timer = setInterval(function () {
                    var speed = parseInt(getStyle(div,'left')) + 12;
                    if(speed>900){
                        speed = 900;
                    }
                    div.style.left =speed + 'px';
                    if(speed ==900){
                        clearInterval(div.timer);
                    }
                 },20);
                 */

            };
            btn2.onclick = function () {
                moveFn(div,'left',12,20);
            };
            btn3.onclick = function () {
                moveFn(div,'left',12,900,function () {
                    moveFn(div,'top',12,700,function () {
                        moveFn(div,'left',12,20,function () {
                            moveFn(div,'top',12,40);
                        });
                    });
                });
            };

        };

        //移动函数
        function moveFn(obj,attr,dir,target,endFn) {
            dir = parseInt(getStyle( obj, attr )) < target ? dir : -dir;//判断方向

            clearInterval( obj.timer );

            obj.timer = setInterval(function () {

                var speed = parseInt(getStyle( obj, attr )) + dir;			// 步长

                if ( speed > target && dir > 0 ||  speed < target && dir < 0  ) {
                    speed = target;
                }

                obj.style[attr] = speed + 'px';

                if ( speed == target ) {
                    clearInterval( obj.timer );
                    if(endFn){  //先判断是否到目标坐标后在判断是否有回调函数
                        endFn();
                    }
                }

            }, 30);
        }
        //获取元素属性的兼容性函数
        function getStyle(obj,attr) {
            return obj.currentStyle?obj.currentStyle[attr]:getComputedStyle(obj)[attr];
        }

    </script>
</head>
<body>
    <button id="btn1">向前走</button>
    <button id="btn2">向后退</button>
    <button id="btn3">大千世界 因果轮回(回调函数)</button>
    <div id="div"></div>


</body>
</html>